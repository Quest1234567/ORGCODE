This is code of verison 2
